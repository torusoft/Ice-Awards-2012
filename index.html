<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no"/>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
<title>Instagram</title>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script> 
<style>
html, body { height: 720px; margin: 0; padding: 0; background: #000; width: 1280px; border: 1px solid red; position: relative; top: 0px; left: 0px;}

#panel { height: auto; float: right; width: 100%; }
#panel .photoWrapper { width: 150px; height: 150px; margin:2px; float:left; box-shadow: 0 2px 2px rgba(33, 33, 33, 0.4); display:none;}
#panel. photoWrapper .photo { width: auto; height: auto; }

.instagram-container{width: 486px; height: 252px; background: gray; overflow: hidden;}

.twitter-feed-area{position: absolute; bottom: 0px; right: 0px; width: 360px; height: 585px; background: #000; background: gray;}
.twitter-feed{width: 324px; height: 376px; background: url('twitter-feed-background.png') no-repeat; margin: 154px 18px 0px 18px;}
.twitter-feed-area A{display:block; width: 225px; height: 36px; background: url('twitter-bubble.png') no-repeat; float: right; margin: 8px 18px 18px 18px; color: red; font-size: 18px; font-family: Helvetica, sans-serif; font-weight: bold; text-indent: 10px; padding: 2px;}
</style>
<script type="text/javascript">
<!--

var offset = "";

$(document).ready(function(){

	getNewPhotos();
	var poll_token = setInterval(getNewPhotos, 20000);

	var photo_stack = [];

	function getNewPhotos(){
		console.log("calling " + "https://api.instagram.com/v1/tags/halifax/media/recent?max_id=" + offset + "&callback=?")
		$.getJSON("https://api.instagram.com/v1/tags/halifax/media/recent?max_id=" + offset + "&callback=?",{access_token:'3794301.f59def8.e08bcd8b10614074882b2d1b787e2b6f'}, function(data){
			if(data.meta.code == 200) {

				var photos = data.data;

				if(photos.length > 0) {

					photo_stack = photos.concat(photo_stack);
					offset = photos[0].id;

					for (var key in photos){
						console.log(key);
						var photo = photos[key];
						$('<div id=p' + photo.id + '></div>').addClass('photoWrapper').appendTo('#panel');
						
						var str = '<img id="' + photo.id + '" src="' + photo.images.thumbnail.url + '" width="100%">';
						$('<div></div>').addClass('photo').html(str).appendTo('#p' + photo.id);
			
						$('#' + photo.id).load(function() {
							$('#p' + $(this).attr('id')).fadeTo('slow', 1.0);
						});
	
					}
				}else{
					console.log('empty');
				}
				
			}else{
				console.log(data.meta.error_message);
			}
	
		});
	}

});
//-->
</script>
</head>
<body>

<div class="instagram-container">
<div id="panel"></div>
</div>



<div class="twitter-feed-area">
	<div class="twitter-feed">Feed here</div>
	<a>#IceAwards2012</a>
</div>
</body>
</html>